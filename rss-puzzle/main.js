(()=>{"use strict";var e={52:(e,t,n)=>{n.d(t,{c:()=>a});var r=n(500),s=n.n(r),o=n(312),i=n.n(o)()(s());i.push([e.id,".button {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    border-radius: 10px;\n    border: 1px solid #665f55;\n    background: #ffffff;\n    cursor: pointer;\n    padding: 0.8rem;\n    font-size: 1.2rem;\n    margin-top: 0.3rem;\n    transition: all 0.7s ease;\n}\n\nbutton:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n}\n\n.button:hover:not(:disabled) {\n    background: #60ad7a;\n    border: 1px solid transparent;\n    color: #ffffff;\n}\n\n.button-game {\n    font-size: 0.8rem;\n    padding: 0.3rem;\n    margin-right: 20px;\n    width: 120px;\n}\n",""]);const a=i},64:(e,t,n)=>{n.d(t,{c:()=>a});var r=n(500),s=n.n(r),o=n(312),i=n.n(o)()(s());i.push([e.id,".game-container {\n    max-width: 800px;\n    min-width: 760px;\n    margin: 0 auto;\n}\n\n.game-field {\n    min-height: 300px;\n    background-color: antiquewhite;\n}\n\n.result-block {\n    max-width: 700px;\n    margin-bottom: 10px;\n    border: 1px solid gray;\n}\n\n.source-block {\n    display: flex;\n    max-width: 700px;\n    padding: 5px;\n    min-height: 50px;\n}\n\n.sentence {\n    display: flex;\n}\n\n.sentence .gap {\n    flex: 1 0 0%;\n    box-shadow: inset 0 0 0 1px #e1e1e1;\n}\n\n.sentence .gap.error .puzzle {\n    color: rgb(201, 89, 89);\n}\n\n.puzzle {\n    position: relative;\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    text-align: center;\n    padding: 5px;\n    cursor: pointer;\n    opacity: 0;\n    animation: ani 0.6s forwards;\n    background-repeat: no-repeat;\n    color: white;\n    text-shadow:\n        1px 0 1px #000,\n        0 1px 1px #000,\n        -1px 0 1px #000,\n        0 -1px 1px #000;\n}\n.puzzle:before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    box-shadow: inset 0 0 0 2px white;\n}\n.puzzle,\n.gap {\n    height: 2.4rem;\n}\n\n.sentence .puzzle {\n    width: 100%;\n}\n\n.puzzle.error {\n    border: 1px solid red;\n}\n\n@keyframes ani {\n    0% {\n        opacity: 0;\n    }\n    100% {\n        opacity: 1;\n    }\n}\n\n.solved {\n    cursor: default;\n}\n\n.game-buttons {\n    display: flex;\n    justify-content: center;\n}\n.hidden {\n    display: none;\n}\n",""]);const a=i},104:(e,t,n)=>{n.d(t,{c:()=>a});var r=n(500),s=n.n(r),o=n(312),i=n.n(o)()(s());i.push([e.id,".header {\n    display: flex;\n    justify-content: space-between;\n    padding: 0 10px 10px 10px;\n    max-width: 800px;\n    min-width: 700px;\n}\n\n.title {\n    font-size: 1.5rem;\n}\n",""]);const a=i},816:(e,t,n)=>{n.d(t,{c:()=>a});var r=n(500),s=n.n(r),o=n(312),i=n.n(o)()(s());i.push([e.id,".game-page {\n    width: 100%;\n    height: 100%;\n    position: relative;\n    padding: 30px;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n}\n\n.button-logout {\n    width: 30px;\n    height: 30px;\n    margin-right: 10%;\n}\n",""]);const a=i},228:(e,t,n)=>{n.d(t,{c:()=>h});var r=n(500),s=n.n(r),o=n(312),i=n.n(o),a=n(536),d=n.n(a),l=new URL(n(956),n.b),c=i()(s()),u=d()(l);c.push([e.id,`.wrapper {\n    width: 100%;\n    height: 100%;\n    display: grid;\n    align-items: center;\n    background: center / cover no-repeat url(${u});\n}\n\n.login-block {\n    width: 350px;\n    height: 250px;\n    border: 1px solid transparent;\n    border-radius: 5px;\n    padding: 10px;\n    text-align: center;\n    background-color: aliceblue;\n    margin: auto;\n}\n\n.login-form {\n    display: flex;\n    flex-direction: column;\n    justify-content: space-between;\n    align-items: center;\n    margin: 10px;\n    margin-top: 5%;\n}\n\n.login-form__input {\n    margin-top: 8px;\n    margin-bottom: 8px;\n    padding: 5px;\n    border-radius: 5px;\n    max-width: 90%;\n}\n\n.valid {\n    border: 1px solid green;\n}\n\n.invalid {\n    border: 1px solid red;\n}\n\n.login-form__error {\n    min-height: 1.5rem;\n    display: block;\n    font-size: 0.7rem;\n    letter-spacing: 0.8px;\n    color: red;\n    position: relative;\n}\n\ninput.invalid + span:after {\n    content: attr(data-error-text);\n    display: inline-block;\n    max-width: 80%;\n}\n`,""]);const h=c},12:(e,t,n)=>{n.d(t,{c:()=>a});var r=n(500),s=n.n(r),o=n(312),i=n.n(o)()(s());i.push([e.id,".modal {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100vh;\n    background: content-box radial-gradient(rgb(231, 214, 57), rgb(72, 230, 151));\n    display: grid;\n    place-items: center;\n    z-index: 2;\n}\n\n.modal__content {\n    max-width: 50%;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    text-align: center;\n    gap: 2rem;\n}\n\n.modal__title {\n    color: white;\n    text-transform: uppercase;\n    letter-spacing: 3px;\n    font-size: 2rem;\n    font-weight: normal;\n}\n\n.modal__description {\n    font-size: 1rem;\n    font-weight: normal;\n}\n\n.button-start {\n    border: 1px solid transparent;\n}\n",""]);const a=i},904:(e,t,n)=>{n.d(t,{c:()=>a});var r=n(500),s=n.n(r),o=n(312),i=n.n(o)()(s());i.push([e.id,"/* :root {\n    font-size: 30px;\n} */\n\n@media (max-width: 600px) {\n    html {\n        font-size: 2.8vw;\n    }\n}\n\n* {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n    font-family: 'Forum', sans-serif;\n    letter-spacing: 1px;\n    font-size: 1rem;\n    font-weight: bold;\n    color: rgb(59, 58, 58);\n}\n\nbody {\n    height: 100vh;\n}\n\nbutton {\n    padding: 0;\n    border: none;\n    font-family: inherit;\n    color: inherit;\n    background-color: transparent;\n    cursor: pointer;\n}\n",""]);const a=i},312:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,s,o){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(r)for(var a=0;a<this.length;a++){var d=this[a][0];null!=d&&(i[d]=!0)}for(var l=0;l<e.length;l++){var c=[].concat(e[l]);r&&i[c[0]]||(void 0!==o&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=o),n&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=n):c[2]=n),s&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=s):c[4]="".concat(s)),t.push(c))}},t}},536:e=>{e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},500:e=>{e.exports=function(e){return e[1]}},596:e=>{var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var o={},i=[],a=0;a<e.length;a++){var d=e[a],l=r.base?d[0]+r.base:d[0],c=o[l]||0,u="".concat(l," ").concat(c);o[l]=c+1;var h=n(u),p={css:d[1],media:d[2],sourceMap:d[3],supports:d[4],layer:d[5]};if(-1!==h)t[h].references++,t[h].updater(p);else{var g=s(p,r);r.byIndex=a,t.splice(a,0,{identifier:u,updater:g,references:1})}i.push(u)}return i}function s(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,s){var o=r(e=e||[],s=s||{});return function(e){e=e||[];for(var i=0;i<o.length;i++){var a=n(o[i]);t[a].references--}for(var d=r(e,s),l=0;l<o.length;l++){var c=n(o[l]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}o=d}}},176:e=>{var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},808:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},120:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},520:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var s=void 0!==n.layer;s&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,s&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},936:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},956:(e,t,n)=>{e.exports=n.p+"assets/bg.dccd3e5a46b594846bd4.jpg"}},t={};function n(r){var s=t[r];if(void 0!==s)return s.exports;var o=t[r]={id:r,exports:{}};return e[r](o,o.exports,n),o.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var s=r.length-1;s>-1&&!e;)e=r[s--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),n.b=document.baseURI||self.location.href,n.nc=void 0,(()=>{var e=n(596),t=n.n(e),r=n(520),s=n.n(r),o=n(176),i=n.n(o),a=n(120),d=n.n(a),l=n(808),c=n.n(l),u=n(936),h=n.n(u),p=n(904),g={};g.styleTagTransform=h(),g.setAttributes=d(),g.insert=i().bind(null,"head"),g.domAPI=s(),g.insertStyleElement=c(),t()(p.c,g),p.c&&p.c.locals&&p.c.locals;class m{constructor(e,...t){var n;this.children=[];const r=document.createElement(null!==(n=e.tag)&&void 0!==n?n:"div");if(Object.assign(r,e),e.data)for(const t in e.data)r.dataset[t]=e.data[t];this.node=r,t&&this.appendChildren(t)}append(e){e instanceof m?(this.children.push(e),this.node.append(e.getNode())):this.node.append(e)}appendChildren(e){e.forEach((e=>{e&&this.append(e)}))}setTextContent(e){this.node.textContent=e}getNode(){return this.node}addClass(e){this.node.classList.add(e)}removeClass(e){this.node.classList.remove(e)}addListener(e,t){this.node.addEventListener(e,t)}destroyChildren(){this.children.forEach((e=>{e.destroy()})),this.children.length=0}destroy(){this.destroyChildren(),this.node.remove()}}var f=n(52),v={};v.styleTagTransform=h(),v.setAttributes=d(),v.insert=i().bind(null,"head"),v.domAPI=s(),v.insertStyleElement=c(),t()(f.c,v),f.c&&f.c.locals&&f.c.locals;class b extends m{constructor(e){super(Object.assign({tag:"button"},e))}show(){this.node.style.display=""}hide(){this.node.style.display="none"}enable(){this.node.removeAttribute("disabled")}disable(){this.node.setAttribute("disabled","")}}class x extends m{constructor(e){super(e),this.render()}}var y=n(228),w={};w.styleTagTransform=h(),w.setAttributes=d(),w.insert=i().bind(null,"head"),w.domAPI=s(),w.insertStyleElement=c(),t()(y.c,w),y.c&&y.c.locals&&y.c.locals;class N extends x{constructor(){super({className:"wrapper"})}render(){const e=new m({tag:"form",className:"login-form",action:"#",autocomplete:"off"},new m({tag:"input",type:"text",name:"name",className:"login-form__input",placeholder:"Name",pattern:"[A-Z][A-Za-z\\-]{2,}",required:!0}),new m({tag:"span",className:"login-form__error",data:{errorText:"Enter your name starting with the capital letter, minimum 3 characters"}}),new m({tag:"input",type:"text",name:"surname",className:"login-form__input",placeholder:"Surname",pattern:"[A-Z][A-Za-z\\-]{3,}",required:!0}),new m({tag:"span",className:"login-form__error",data:{errorText:"Enter your name starting with the capital letter, minimum 4 characters"}}),new b({className:"button",textContent:"Login",disabled:!0})),t=new m({className:"login-block"},new m({tag:"p",className:"login-title",textContent:"Welcome! Login to start learning!"}),e);e.getNode().addEventListener("keyup",this.handleKeyUp),e.getNode().addEventListener("submit",(e=>{this.handleSubmit(e)})),this.appendChildren([t])}handleKeyUp(e){const t=e.target;if(!t||!t.form)return;const n=t.form;t.checkValidity()?(t.classList.remove("invalid"),t.classList.add("valid")):(t.classList.remove("valid"),t.classList.add("invalid"));const r=n.querySelector("button");n.checkValidity()?null==r||r.removeAttribute("disabled"):null==r||r.setAttribute("disabled","disabled")}handleSubmit(e){const t=e.target;if(!t)return;e.preventDefault();const n={name:t.getElementsByTagName("input")[0].value||"",surname:t.getElementsByTagName("input")[1].value||""};localStorage.setItem("user",JSON.stringify(n)),document.dispatchEvent(new Event("auth"))}}var C=n(104),S={};S.styleTagTransform=h(),S.setAttributes=d(),S.insert=i().bind(null,"head"),S.domAPI=s(),S.insertStyleElement=c(),t()(C.c,S),C.c&&C.c.locals&&C.c.locals;class E extends m{constructor(){const e=new m({tag:"h1",className:"title",textContent:"RSS-Puzzle"}),t=new b({className:" button-logout",title:"Logout"}).getNode();t.insertAdjacentHTML("beforeend",'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M377.9 105.9L500.7 228.7c7.2 7.2 11.3 17.1 11.3 27.3s-4.1 20.1-11.3 27.3L377.9 406.1c-6.4 6.4-15 9.9-24 9.9c-18.7 0-33.9-15.2-33.9-33.9l0-62.1-128 0c-17.7 0-32-14.3-32-32l0-64c0-17.7 14.3-32 32-32l128 0 0-62.1c0-18.7 15.2-33.9 33.9-33.9c9 0 17.6 3.6 24 9.9zM160 96L96 96c-17.7 0-32 14.3-32 32l0 256c0 17.7 14.3 32 32 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32l-64 0c-53 0-96-43-96-96L0 128C0 75 43 32 96 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32z"/></svg>'),t.addEventListener("click",(()=>{localStorage.clear(),sessionStorage.clear(),document.dispatchEvent(new Event("auth"))})),super({tag:"header",className:"header"},e,t)}}class L extends m{constructor(e,t){super(Object.assign(Object.assign({},e),{tag:"select"}),...t.map((e=>new m(Object.assign({tag:"option"},e)))))}}class k extends m{constructor(){super({className:"gap",tag:"div"}),this.observer=new MutationObserver((()=>{this.setWidth()})),this.observer.observe(this.node,{childList:!0})}destroyChildren(){super.destroyChildren(),this.observer.disconnect()}hasWordNode(){return this.node.hasChildNodes()}setWidth(){var e;const t=this.getWordNode();t?(this.node.style.flexBasis=null===(e=null==t?void 0:t.style)||void 0===e?void 0:e.minWidth,this.node.style.flexGrow="0"):(this.node.style.flexBasis="",this.node.style.flexGrow="")}addWord(e){if(this.hasWordNode())throw new Error;this.node.append(e.getNode())}getWordNode(){return this.node.firstElementChild}}var z=n(64),T={};T.styleTagTransform=h(),T.setAttributes=d(),T.insert=i().bind(null,"head"),T.domAPI=s(),T.insertStyleElement=c(),t()(z.c,T),z.c&&z.c.locals&&z.c.locals;class A extends m{constructor(e){super({className:"sentence"}),this.sentence=e,this.correct=[],this.children=[],this.correct=e.split(/(?<!and)\s(?!and)/),this.correct.map((()=>{this.append(new k)}))}add(e){if(!this.children.some((t=>!t.hasWordNode()&&(t.addWord(e),!0))))throw new Error}clearGaps(){this.children.map((e=>e.getNode().innerHTML=""))}isFilled(){return this.children.every((e=>e.hasWordNode()))}isCorrect(){return this.correct.every(((e,t)=>{var n;const r=null===(n=this.children[t])||void 0===n?void 0:n.getWordNode();return!!r&&r.textContent===e}))}finish(){setTimeout((()=>{var e;const t=this.getNode().cloneNode(!0);t.classList.add("solved"),null===(e=this.getNode().parentNode)||void 0===e||e.replaceChild(t,this.getNode())}))}showErrors(){return document.addEventListener("pointerdown",(()=>{this.children.map((e=>e.removeClass("error")))}),{once:!0}),this.children.map(((e,t)=>{const n=e.getWordNode();n&&this.correct[t]!==n.textContent?e.addClass("error"):e.removeClass("error")}))}getCorrect(){return Object.values(this.correct)}}class _ extends m{constructor(e){super({className:"result-block"}),this.round=e,this.currentSentence=0,this.sentences=[],this.image=e.levelData.imageSrc,e.words.forEach((e=>{this.sentences.push(new A(e.textExample))})),this.appendChildren(this.sentences)}getCurrentSentence(){return this.sentences[this.currentSentence]}nextSentence(){return this.sentences[++this.currentSentence]}getSentencesCount(){return this.sentences.length}getCurrentSentenceNumber(){return this.currentSentence}getImage(){return this.image}}class W extends m{constructor(e,t,n){super({className:"puzzle",tag:"div",textContent:e}),this.value=e,this.setWidth(t),this.node.style.overflow="hidden",this.node.style.position="relative",this.background=document.createElement("div"),this.background.classList.add("puzzle-background"),this.background.innerHTML=`<img src="https://raw.githubusercontent.com/rolling-scopes-school/rss-puzzle-data/main/images/${n}" style="display: block; width: 100%" />`,this.background.style.position="absolute",this.background.style.zIndex="-1",this.background.style.top="0",this.background.style.left="0",this.background.style.pointerEvents="none",this.append(this.background)}getValue(){return this.value}setWidth(e){this.node.style.minWidth=`${Math.floor(e)}%`}setPadding(e,t){this.background.style.translate=`${e} 0`,this.background.style.top=t}setBackgroundWidth(e){this.background.style.width=e}getWidth(){return parseFloat(this.node.style.minWidth)}}class I extends m{constructor(e){super({className:"source-block"}),this.result=e,this.words=[],this.callbacks=[],window.addEventListener("resize",(()=>{Object.values(document.querySelectorAll(".puzzle-background")).map((e=>{e.style.width=`${this.result.getNode().offsetWidth}px`}))}))}addCallback(e){this.callbacks.push(e)}initWords(e){this.destroyChildren();const t=e.reduce(((e,t)=>e+t.length),0);let n=100;this.words=e.map((e=>{const r=Math.floor(e.length/t*100),s=new W(e,r,this.result.getImage());return n-=r,s}));const r=Object.values(this.words).sort(((e,t)=>e.getValue().length-t.getValue().length));for(let e=0;e<n;e++){const t=r[e];if(!t)return;t.setWidth(t.getWidth()+1)}n=0;const s=this.result.getCurrentSentenceNumber()/this.result.getSentencesCount()*100;this.words.map((e=>{var t;e.setPadding(`-${n}%`,`-${10*s}%`),n+=e.getWidth(),null===(t=e.getNode().querySelector("img"))||void 0===t||t.addEventListener("load",(()=>{this.updateWordBackground(e)}),{once:!0})})),this.render()}updateWordBackground(e){const t=this.result.getNode().offsetWidth;t&&e.setBackgroundWidth(`${t}px`)}getWords(){return Object.values(this.words)}render(){this.destroyChildren(),Object.values(this.words).sort((()=>.5-Math.random())).map((e=>{e.addListener("click",(()=>{const t=this.result.getCurrentSentence();if(!t)throw new Error;this.getNode().contains(e.getNode())?t.add(e):this.append(e),this.callbacks.forEach((t=>t(e)))})),this.append(e)}))}}class j extends m{constructor(){super({className:"game-container"}),this.LEVEL_COUNT=6,this.URL_TEMPLATE="//raw.githubusercontent.com/rolling-scopes-school/rss-puzzle-data/main/data/wordCollectionLevel%lvl%.json",this.level=1,this.round=0,this.data={rounds:[]},this.loadProgress(),this.fetchLevel()}loadProgress(){this.level=parseInt(localStorage.getItem("last-level")||"")||1,this.round=parseInt(localStorage.getItem("last-round")||"")||0}saveProgress(){localStorage.setItem("last-level",this.level.toString()),localStorage.setItem("last-round",this.round.toString())}renderRound(){this.saveProgress(),this.destroyChildren();const e=this.data.rounds[this.round],t=new _(e),n=t.getCurrentSentence();if(!n)return;const r=new I(t);r.initWords(n.getCorrect());const s=new b({className:"button button-game",id:"solutionButton",textContent:"Show solution"}),o=new b({className:"button button-game",id:"checkButton",textContent:"Check",disabled:!0}),i=new b({className:"button button-game",id:"continueButton",textContent:"Continue"});i.hide(),o.addListener("click",(()=>{var e;null===(e=t.getCurrentSentence())||void 0===e||e.showErrors()})),i.addListener("click",(()=>{var e;t.nextSentence()?(r.initWords(null===(e=t.getCurrentSentence())||void 0===e?void 0:e.getCorrect()),i.hide(),o.show()):this.data.rounds[this.round+1]?(this.round++,this.renderRound()):this.level+1<=this.LEVEL_COUNT?(this.round=0,this.level++,this.fetchLevel()):(this.round=0,this.level=1,this.fetchLevel())})),r.addCallback((()=>{const e=t.getCurrentSentence();e&&(e.isFilled()?e.isCorrect()?(e.finish(),o.hide(),i.show()):o.enable():o.disable())})),s.addListener("click",(()=>{const e=t.getCurrentSentence();if(!e)throw new Error;e.clearGaps(),r.getWords().map((t=>{e.add(t)})),e.finish(),i.show(),o.hide()}));const a=new m({className:"game-buttons"},s,o,i);this.appendChildren([...this.createControls(),t,r,a])}createControls(){const e=new L({},Array.from(Array(this.LEVEL_COUNT).keys(),(e=>{const t=e+1;return{value:t.toString(),textContent:`Level ${t}`,selected:t===this.level}})));e.addListener("change",(()=>{this.level=parseInt(e.getNode().value),this.fetchLevel()}));const t=new L({},this.data.rounds.map(((e,t)=>{const n=t+1;return{value:t.toString(),textContent:`Round ${n}`,selected:t===this.round}})));return t.addListener("change",(()=>{this.round=+t.getNode().value,this.renderRound()})),[e,t]}fetchLevel(){fetch(this.URL_TEMPLATE.replace("%lvl%",this.level.toString())).then((e=>{return t=this,n=void 0,s=function*(){this.data=yield e.json(),console.log(this.data),this.renderRound()},new((r=void 0)||(r=Promise))((function(e,o){function i(e){try{d(s.next(e))}catch(e){o(e)}}function a(e){try{d(s.throw(e))}catch(e){o(e)}}function d(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(i,a)}d((s=s.apply(t,n||[])).next())}));var t,n,r,s}))}}var O=n(816),P={};P.styleTagTransform=h(),P.setAttributes=d(),P.insert=i().bind(null,"head"),P.domAPI=s(),P.insertStyleElement=c(),t()(O.c,P),O.c&&O.c.locals&&O.c.locals;class M extends x{constructor(e){super({className:"game-page"}),this.userData=e}render(){this.append(new E),this.append(new j)}}var $=n(12),B={};B.styleTagTransform=h(),B.setAttributes=d(),B.insert=i().bind(null,"head"),B.domAPI=s(),B.insertStyleElement=c(),t()($.c,B),$.c&&$.c.locals&&$.c.locals;class U extends x{constructor(){super({className:"modal"})}render(){const e=new m({className:"modal__content"},new m({tag:"h2",className:"modal__title",textContent:"English puzzle"}),new m({tag:"p",className:"modal__greeting",textContent:`Greetings, ${this.fetchUserData()}!`}),new m({tag:"p",className:"modal__description",textContent:"Learn English in an easy and fun way. Build puzzles and improve your language!"}),new b({className:"button button-start",textContent:"Start"})),t=e.getNode().querySelector("button");t&&t.addEventListener("click",(()=>{sessionStorage.setItem("started","true"),document.dispatchEvent(new Event("auth"))})),this.appendChildren([e]),document.body.append(this.getNode())}fetchUserData(){const e=JSON.parse(localStorage.getItem("user")),t=e.name;if(e)return`${t} ${e.surname}`}}new class{constructor(e){this.root=e}init(){document.addEventListener("auth",(()=>{this.init()}),{once:!0}),this.isAuth()&&this.isStarted()?this.render(new M(this.user)):this.isAuth()?this.render(new U):this.render(new N)}render(e){this.page&&this.page.destroy(),this.page=e,this.root.append(e.getNode())}isAuth(){const e=localStorage.getItem("user");return!!e&&(this.user=JSON.parse(e),!0)}isStarted(){return Boolean(sessionStorage.getItem("started"))}}(document.body).init()})()})();